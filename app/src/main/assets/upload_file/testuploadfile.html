<!DOCTYPE html>
<html style="width: 100%;height: 100%;margin: 0;padding: 0">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Pragma" content="no-cache">
    <link rel="stylesheet" type="text/css" href="./upload.css">
    <title>上传身份证</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script language="javascript">
    $(function() {
        form.reset(); //清除浏览器记录的上次记录
        var file;
        $(form).on("change", "#file_upload", function() {
            var $file = $(this);
            var fileObj = $file[0];
            var windowURL = window.URL || window.webkitURL;
            var dataURL;
            var $img = $("#preview");
            if (fileObj && fileObj.files && fileObj.files[0]) {
                dataURL = windowURL.createObjectURL(fileObj.files[0]);
                $img.attr('src', dataURL);
            } else {
                console.log("else  upload");
                dataURL = $file.val();
                var imgObj = document.getElementById("preview");
                // 两个坑:
                // 1、在设置filter属性时，元素必须已经存在在DOM树中，动态创建的Node，也需要在设置属性前加入到DOM中，先设置属性在加入，无效；
                // 2、src属性需要像下面的方式添加，上面的两种方式添加，无效；
                imgObj.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";
                imgObj.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = dataURL;
            }
            //每次选中都保存旧元素，并使用新的控件替换
            $(this).clone().replaceAll(file = this);
        }).submit(function() {
            //提交时把之前保存的旧元素替换回去
            $("#file_upload").replaceWith(file);
        });
        $(form).on("change", "#file_upload1", function() {
            var $file = $(this);
            var fileObj = $file[0];
            var windowURL = window.URL || window.webkitURL;
            var dataURL;
            var $img = $("#preview1");
            if (fileObj && fileObj.files && fileObj.files[0]) {
                dataURL = windowURL.createObjectURL(fileObj.files[0]);
                $img.attr('src', dataURL);
            } else {
                console.log("else  upload");
                dataURL = $file.val();
                var imgObj = document.getElementById("preview1");
                // 两个坑:
                // 1、在设置filter属性时，元素必须已经存在在DOM树中，动态创建的Node，也需要在设置属性前加入到DOM中，先设置属性在加入，无效；
                // 2、src属性需要像下面的方式添加，上面的两种方式添加，无效；
                imgObj.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";
                imgObj.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = dataURL;
            }
            //每次选中都保存旧元素，并使用新的控件替换
            $(this).clone().replaceAll(file = this);
        }).submit(function() {
            //提交时把之前保存的旧元素替换回去
            $("#file_upload1").replaceWith(file);
        });
    });
    </script>
</head>
<body style="width: 100%;height: 100%;margin: 0;padding: 0; position: relative;background: #ebebeb">
<div style="position: absolute; left: 0 ;right: 0 ; top: 0 ; margin:0 auto;max-width: 750px;height: 100%">
    <form id="form">
        <img id="preview" src="./id.png"
             style="display: block;margin: 0 auto;max-width: 60%;margin-top: 20px">
        </img>
        <input id="file_upload" type="file" name="" accept=*/*,"
               capture="camera" multiple="multiple">
        <img id="preview1" src="./id.png"
             style="display: block;margin: 0 auto;max-width: 60%;margin-top: 20px">
        </img>
        <input id="file_upload1" type="file" name="" accept=*/*,"
               capture="camera" multiple="multiple">
    </form>
</div>
</body>

</html>